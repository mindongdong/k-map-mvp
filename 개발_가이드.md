# K-MAP 개발 가이드

## 📋 프로젝트 구조

이 프로젝트는 **개발 준비 상태**로 설정되어 있습니다. 모든 파일은 구조와 가이드 주석만 포함하고 있으며, 실제 구현은 개발자가 진행해야 합니다.

```
K-MAP-mvp/
├── backend/                 # FastAPI 백엔드
│   ├── app/
│   │   ├── main.py         # 🔧 FastAPI 앱 설정
│   │   ├── core/           # 핵심 설정
│   │   │   ├── config.py   # 🔧 환경변수 및 설정
│   │   │   └── database.py # 🔧 DB 연결 설정
│   │   ├── models/         # SQLAlchemy 모델
│   │   │   └── dataset.py  # 🔧 Dataset 테이블 정의
│   │   ├── schemas/        # Pydantic 스키마
│   │   │   └── dataset.py  # 🔧 API 스키마 정의
│   │   └── api/            # API 라우터
│   │       ├── datasets.py     # 🔧 데이터셋 API
│   │       ├── visualizations.py # 🔧 시각화 API
│   │       └── admin.py    # 🔧 관리자 API
│   ├── requirements.txt    # ✅ Python 의존성
│   └── Dockerfile         # 🔧 Docker 설정
├── frontend/               # React 프론트엔드
│   ├── src/
│   │   ├── index.tsx      # 🔧 React 진입점
│   │   ├── App.tsx        # 🔧 메인 앱 컴포넌트
│   │   ├── components/    # 재사용 컴포넌트
│   │   │   └── Layout/    # 🔧 헤더, 푸터
│   │   ├── pages/         # 페이지 컴포넌트
│   │   │   ├── HomePage.tsx        # 🔧 홈페이지
│   │   │   ├── DatasetsPage.tsx    # 🔧 데이터셋 목록
│   │   │   ├── DatasetDetailPage.tsx # 🔧 데이터셋 상세
│   │   │   ├── VisualizationPage.tsx # 🔧 시각화 페이지
│   │   │   └── AdminPage.tsx       # 🔧 관리자 페이지
│   │   ├── services/      # API 서비스
│   │   │   └── api.ts     # 🔧 HTTP 클라이언트
│   │   ├── types/         # TypeScript 타입
│   │   │   └── api.ts     # 🔧 API 타입 정의
│   │   ├── hooks/         # 커스텀 훅
│   │   │   └── useApi.ts  # 🔧 API 호출 훅
│   │   ├── utils/         # 유틸리티
│   │   │   └── formatters.ts # 🔧 포맷팅 함수
│   │   └── styles/        # 스타일시트
│   │       ├── globals.css    # 🔧 전역 스타일
│   │       ├── components.css # 🔧 컴포넌트 스타일
│   │       ├── layout.css     # 🔧 레이아웃 스타일
│   │       └── pages.css      # 🔧 페이지 스타일
│   ├── package.json       # ✅ Node.js 의존성
│   ├── tsconfig.json      # ✅ TypeScript 설정
│   └── Dockerfile         # 🔧 Docker 설정
├── docker-compose.yml     # 🔧 개발환경 오케스트레이션
├── .gitignore            # ✅ Git 제외 파일
├── backend/.env.example  # ✅ 백엔드 환경변수 템플릿
├── frontend/.env.example # ✅ 프론트엔드 환경변수 템플릿
└── .env.example          # ✅ 프로덕션 환경변수 템플릿
```

**범례:**

- ✅ **완성됨**: 바로 사용 가능
- 🔧 **구현 필요**: 가이드 주석만 있음, 실제 코드 작성 필요

## 🚀 개발 시작하기

### 1. 환경 설정

```bash
# 환경변수 파일 생성
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env

# 필요시 환경변수 값 수정
# backend/.env: 데이터베이스 설정
# frontend/.env: API URL 설정
```

### 2. Docker로 개발환경 실행

```bash
# 전체 스택 실행
docker compose up --build

# 개별 서비스 실행
docker compose up db          # 데이터베이스만
docker compose up backend db  # 백엔드 + 데이터베이스
docker compose up frontend    # 프론트엔드만
```

### 3. 접속 URL

- **프론트엔드**: http://localhost:3000
- **백엔드 API**: http://localhost:8000
- **API 문서**: http://localhost:8000/docs (구현 후)
- **PostgreSQL**: localhost:5432

## 🔧 구현 순서 가이드

### Phase 1: Backend 기본 구조 (1-2일)

1. **`backend/app/core/config.py`**: 환경변수 및 설정 클래스 구현
2. **`backend/app/core/database.py`**: SQLAlchemy 엔진 및 세션 설정
3. **`backend/app/models/dataset.py`**: Dataset 모델 정의
4. **`backend/app/main.py`**: FastAPI 앱 초기화 및 라우터 등록

### Phase 2: Backend API 구현 (2-3일)

1. **`backend/app/schemas/dataset.py`**: Pydantic 스키마 정의
2. **`backend/app/api/datasets.py`**: 데이터셋 CRUD API 구현
3. **`backend/app/api/admin.py`**: 관리자 인증 및 관리 API 구현
4. **`backend/app/api/visualizations.py`**: 시각화 데이터 API 구현

### Phase 3: Frontend 기본 구조 (1-2일)

1. **`frontend/src/styles/`**: CSS 스타일 구현
2. **`frontend/src/types/api.ts`**: TypeScript 타입 정의
3. **`frontend/src/services/api.ts`**: Axios 클라이언트 및 API 서비스 구현
4. **`frontend/src/App.tsx`**: 라우터 설정

### Phase 4: Frontend 컴포넌트 구현 (3-4일)

1. **레이아웃 컴포넌트**: Header, Footer 구현
2. **페이지 컴포넌트**: 각 페이지별 UI 및 기능 구현
3. **훅 및 유틸리티**: API 호출 훅, 포맷팅 함수 구현
4. **스타일링**: 반응형 디자인 및 UX 개선

### Phase 5: 통합 및 테스트 (1-2일)

1. **API 연동**: 프론트엔드-백엔드 통신 테스트
2. **데이터베이스**: 실제 데이터 연동 및 테스트
3. **시각화**: Plotly.js 차트 구현
4. **배포 준비**: Docker 설정 최적화

## 📚 주요 라이브러리 및 도구

### Backend

- **FastAPI**: 고성능 Python 웹 프레임워크
- **SQLAlchemy**: ORM 및 데이터베이스 추상화
- **Pydantic**: 데이터 검증 및 직렬화
- **Plotly**: 시각화 데이터 생성
- **psycopg2-binary**: PostgreSQL 드라이버

### Frontend

- **React 18**: 최신 React + Hooks
- **TypeScript**: 타입 안전성
- **React Router**: 클라이언트 사이드 라우팅
- **Plotly.js**: 인터랙티브 시각화
- **Axios**: HTTP 클라이언트

## 🎯 개발 팁

### Backend 개발

1. **API 우선 개발**: 먼저 API 스키마를 정의하고 구현
2. **타입 힌트 필수**: 모든 함수에 타입 힌트 추가
3. **에러 처리**: HTTPException을 활용한 명확한 에러 메시지
4. **임시 데이터**: 초기 개발시 mock 데이터로 API 테스트

### Frontend 개발

1. **컴포넌트 분리**: 재사용 가능한 작은 컴포넌트로 분리
2. **커스텀 훅**: API 호출 로직을 훅으로 분리
3. **에러 처리**: 로딩, 에러 상태를 항상 고려
4. **타입 안전성**: API 응답에 대한 정확한 타입 정의

### Docker 개발

1. **볼륨 마운트**: 코드 변경사항을 실시간 반영
2. **로그 확인**: `docker compose logs [service]`로 디버깅
3. **컨테이너 재시작**: `docker compose restart [service]`
4. **DB 초기화**: `docker compose down -v`로 볼륨 삭제

## 🔍 디버깅 가이드

### 일반적인 문제와 해결방법

1. **포트 충돌**: 이미 사용중인 포트 확인 및 변경
2. **환경변수 오류**: .env 파일 경로 및 내용 확인
3. **의존성 오류**: requirements.txt, package.json 확인
4. **DB 연결 오류**: PostgreSQL 컨테이너 상태 확인

### 유용한 명령어

```bash
# 컨테이너 상태 확인
docker compose ps

# 로그 확인
docker compose logs backend
docker compose logs frontend
docker compose logs db

# 컨테이너 내부 접속
docker compose exec backend bash
docker compose exec frontend sh

# DB 접속
docker compose exec db psql -U kmap_user -d kmap_db
```

## 📖 참고 문서

- [FastAPI 공식 문서](https://fastapi.tiangolo.com/)
- [React 공식 문서](https://react.dev/)
- [SQLAlchemy 문서](https://docs.sqlalchemy.org/)
- [Plotly.js 문서](https://plotly.com/javascript/)
- [Docker Compose 문서](https://docs.docker.com/compose/)

---

**개발 순서를 따라 단계별로 구현하면서, 각 파일의 TODO 주석을 참고하여 개발을 진행하세요.**
